/**
 * @file table-features.ts
 * @description Funcionalidades de tabla: filtro en todas las columnas y ordenamiento.
 * @author Equipo de Desarrollo
 * @date 2025
 */
/**
 * Inicializa el filtro que busca en todas las columnas de la tabla.
 * @param inputSelector Selector del input de búsqueda
 * @param tableSelector Selector de la tabla
 * @param tbodySelector Selector del tbody
 */
function initTableFilter(inputSelector, tableSelector, tbodySelector) {
    const input = document.querySelector(inputSelector);
    if (!input)
        return;
    input.addEventListener('keyup', function () {
        const searchText = this.value.toLowerCase().trim();
        const rows = document.querySelectorAll(`${tbodySelector} tr.row-app`);
        rows.forEach((row) => {
            const cells = row.querySelectorAll('td:not(.check-cell-app)');
            let found = false;
            cells.forEach((cell) => {
                const cellText = (cell.textContent || '').toLowerCase();
                if (cellText.includes(searchText)) {
                    found = true;
                }
            });
            row.style.display = found ? '' : 'none';
        });
    });
}
/**
 * Estado del ordenamiento por tabla
 */
const sortState = new Map();
/**
 * Inicializa el ordenamiento de columnas al hacer clic en los headers.
 * @param tableSelector Selector de la tabla
 */
function initTableSort(tableSelector) {
    const table = document.querySelector(tableSelector);
    if (!table)
        return;
    const headerRow = table.querySelector('thead tr');
    if (!headerRow)
        return;
    const headers = headerRow.querySelectorAll('td:not(.check-cell-app)');
    headers.forEach((header, index) => {
        const th = header;
        // Agregar estilos de cursor y icono
        th.style.cursor = 'pointer';
        th.style.userSelect = 'none';
        th.style.position = 'relative';
        // Agregar icono de ordenamiento
        if (!th.querySelector('.sort-icon')) {
            const icon = document.createElement('i');
            icon.className = 'fa fa-sort sort-icon';
            icon.style.marginLeft = '5px';
            icon.style.opacity = '0.5';
            icon.style.fontSize = '12px';
            th.appendChild(icon);
        }
        th.addEventListener('click', () => {
            sortTable(tableSelector, index, th);
        });
    });
}
/**
 * Ordena la tabla por la columna especificada.
 */
function sortTable(tableSelector, columnIndex, headerCell) {
    const table = document.querySelector(tableSelector);
    if (!table)
        return;
    const tbody = table.querySelector('tbody');
    if (!tbody)
        return;
    // Obtener estado actual
    const currentState = sortState.get(tableSelector);
    let direction = 'asc';
    if (currentState && currentState.column === columnIndex) {
        direction = currentState.direction === 'asc' ? 'desc' : 'asc';
    }
    // Guardar nuevo estado
    sortState.set(tableSelector, { column: columnIndex, direction });
    // Actualizar iconos de todos los headers
    const allHeaders = table.querySelectorAll('thead td:not(.check-cell-app)');
    allHeaders.forEach((h) => {
        const icon = h.querySelector('.sort-icon');
        if (icon) {
            icon.className = 'fa fa-sort sort-icon';
            icon.style.opacity = '0.5';
        }
    });
    // Actualizar icono del header actual
    const currentIcon = headerCell.querySelector('.sort-icon');
    if (currentIcon) {
        currentIcon.className = direction === 'asc' ? 'fa fa-sort-asc sort-icon' : 'fa fa-sort-desc sort-icon';
        currentIcon.style.opacity = '1';
    }
    // Obtener filas y ordenar
    const rows = Array.from(tbody.querySelectorAll('tr.row-app'));
    rows.sort((a, b) => {
        // +1 porque la primera celda es el checkbox
        const cellA = a.querySelectorAll('td')[columnIndex + 1];
        const cellB = b.querySelectorAll('td')[columnIndex + 1];
        if (!cellA || !cellB)
            return 0;
        let valueA = (cellA.textContent || '').trim();
        let valueB = (cellB.textContent || '').trim();
        // Intentar comparar como números
        const numA = parseFloat(valueA.replace(/[^0-9.-]/g, ''));
        const numB = parseFloat(valueB.replace(/[^0-9.-]/g, ''));
        if (!isNaN(numA) && !isNaN(numB)) {
            return direction === 'asc' ? numA - numB : numB - numA;
        }
        // Intentar comparar como fechas (formato dd/mm/yyyy o similar)
        const dateA = parseDate(valueA);
        const dateB = parseDate(valueB);
        if (dateA && dateB) {
            return direction === 'asc'
                ? dateA.getTime() - dateB.getTime()
                : dateB.getTime() - dateA.getTime();
        }
        // Comparar como texto
        valueA = valueA.toLowerCase();
        valueB = valueB.toLowerCase();
        if (direction === 'asc') {
            return valueA.localeCompare(valueB, 'es');
        }
        else {
            return valueB.localeCompare(valueA, 'es');
        }
    });
    // Reinsertar filas ordenadas
    rows.forEach((row) => tbody.appendChild(row));
}
/**
 * Intenta parsear una fecha en varios formatos comunes.
 */
function parseDate(dateStr) {
    if (!dateStr)
        return null;
    // Formato dd/mm/yyyy
    const parts1 = dateStr.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);
    if (parts1) {
        return new Date(parseInt(parts1[3]), parseInt(parts1[2]) - 1, parseInt(parts1[1]));
    }
    // Formato mm/dd/yyyy
    const parts2 = dateStr.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);
    if (parts2) {
        const date = new Date(parseInt(parts2[3]), parseInt(parts2[1]) - 1, parseInt(parts2[2]));
        if (!isNaN(date.getTime()))
            return date;
    }
    // Formato yyyy-mm-dd
    const parts3 = dateStr.match(/^(\d{4})-(\d{2})-(\d{2})$/);
    if (parts3) {
        return new Date(parseInt(parts3[1]), parseInt(parts3[2]) - 1, parseInt(parts3[3]));
    }
    return null;
}
/**
 * Inicializa todas las funcionalidades de tabla.
 * @param config Configuración de la tabla
 */
function initTableFeatures(config) {
    // Esperar a que el DOM esté listo
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
            initTableFilter(config.filterInput, config.table, config.tbody);
            initTableSort(config.table);
        });
    }
    else {
        initTableFilter(config.filterInput, config.table, config.tbody);
        initTableSort(config.table);
    }
}
// Exportar al ámbito global
window.initTableFeatures = initTableFeatures;
window.initTableFilter = initTableFilter;
window.initTableSort = initTableSort;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFibGUtZmVhdHVyZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9UeXBlU2NyaXB0RmlsZS90YWJsZS1mZWF0dXJlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7R0FLRztBQUVIOzs7OztHQUtHO0FBQ0gsU0FBUyxlQUFlLENBQUMsYUFBcUIsRUFBRSxhQUFxQixFQUFFLGFBQXFCO0lBQ3hGLE1BQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFxQixDQUFDO0lBQ3hFLElBQUksQ0FBQyxLQUFLO1FBQUUsT0FBTztJQUVuQixLQUFLLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFO1FBQzVCLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDbkQsTUFBTSxJQUFJLEdBQUcsUUFBUSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsYUFBYSxhQUFhLENBQUMsQ0FBQztRQUV0RSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUU7WUFDakIsTUFBTSxLQUFLLEdBQUcsR0FBRyxDQUFDLGdCQUFnQixDQUFDLHlCQUF5QixDQUFDLENBQUM7WUFDOUQsSUFBSSxLQUFLLEdBQUcsS0FBSyxDQUFDO1lBRWxCLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTtnQkFDbkIsTUFBTSxRQUFRLEdBQUcsQ0FBQyxJQUFJLENBQUMsV0FBVyxJQUFJLEVBQUUsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO2dCQUN4RCxJQUFJLFFBQVEsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQztvQkFDaEMsS0FBSyxHQUFHLElBQUksQ0FBQztnQkFDakIsQ0FBQztZQUNMLENBQUMsQ0FBQyxDQUFDO1lBRUYsR0FBbUIsQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMs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LGVBQWUsR0FBRyxlQUFlLENBQUM7QUFDakQsTUFBYyxDQUFDLGFBQWEsR0FBRyxhQUFhLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQGZpbGUgdGFibGUtZmVhdHVyZXMudHNcclxuICogQGRlc2NyaXB0aW9uIEZ1bmNpb25hbGlkYWRlcyBkZSB0YWJsYTogZmlsdHJvIGVuIHRvZGFzIGxhcyBjb2x1bW5hcyB5IG9yZGVuYW1pZW50by5cclxuICogQGF1dGhvciBFcXVpcG8gZGUgRGVzYXJyb2xsb1xyXG4gKiBAZGF0ZSAyMDI1XHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIEluaWNpYWxpemEgZWwgZmlsdHJvIHF1ZSBidXNjYSBlbiB0b2RhcyBsYXMgY29sdW1uYXMgZGUgbGEgdGFibGEuXHJcbiAqIEBwYXJhbSBpbnB1dFNlbGVjdG9yIFNlbGVjdG9yIGRlbCBpbnB1dCBkZSBiw7pzcXVlZGFcclxuICogQHBhcmFtIHRhYmxlU2VsZWN0b3IgU2VsZWN0b3IgZGUgbGEgdGFibGFcclxuICogQHBhcmFtIHRib2R5U2VsZWN0b3IgU2VsZWN0b3IgZGVsIHRib2R5XHJcbiAqL1xyXG5mdW5jdGlvbiBpbml0VGFibGVGaWx0ZXIoaW5wdXRTZWxlY3Rvcjogc3RyaW5nLCB0YWJsZVNlbGVjdG9yOiBzdHJpbmcsIHRib2R5U2VsZWN0b3I6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGlucHV0U2VsZWN0b3IpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBpZiAoIWlucHV0KSByZXR1cm47XHJcblxyXG4gICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc3Qgc2VhcmNoVGV4dCA9IHRoaXMudmFsdWUudG9Mb3dlckNhc2UoKS50cmltKCk7XHJcbiAgICAgICAgY29uc3Qgcm93cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYCR7dGJvZHlTZWxlY3Rvcn0gdHIucm93LWFwcGApO1xyXG5cclxuICAgICAgICByb3dzLmZvckVhY2goKHJvdykgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjZWxscyA9IHJvdy5xdWVyeVNlbGVjdG9yQWxsKCd0ZDpub3QoLmNoZWNrLWNlbGwtYXBwKScpO1xyXG4gICAgICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGNlbGxzLmZvckVhY2goKGNlbGwpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNlbGxUZXh0ID0gKGNlbGwudGV4dENvbnRlbnQgfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2VsbFRleHQuaW5jbHVkZXMoc2VhcmNoVGV4dCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgKHJvdyBhcyBIVE1MRWxlbWVudCkuc3R5bGUuZGlzcGxheSA9IGZvdW5kID8gJycgOiAnbm9uZSc7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEVzdGFkbyBkZWwgb3JkZW5hbWllbnRvIHBvciB0YWJsYVxyXG4gKi9cclxuY29uc3Qgc29ydFN0YXRlOiBNYXA8c3RyaW5nLCB7IGNvbHVtbjogbnVtYmVyOyBkaXJlY3Rpb246ICdhc2MnIHwgJ2Rlc2MnIH0+ID0gbmV3IE1hcCgpO1xyXG5cclxuLyoqXHJcbiAqIEluaWNpYWxpemEgZWwgb3JkZW5hbWllbnRvIGRlIGNvbHVtbmFzIGFsIGhhY2VyIGNsaWMgZW4gbG9zIGhlYWRlcnMuXHJcbiAqIEBwYXJhbSB0YWJsZVNlbGVjdG9yIFNlbGVjdG9yIGRlIGxhIHRhYmxhXHJcbiAqL1xyXG5mdW5jdGlvbiBpbml0VGFibGVTb3J0KHRhYmxlU2VsZWN0b3I6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhYmxlU2VsZWN0b3IpIGFzIEhUTUxUYWJsZUVsZW1lbnQ7XHJcbiAgICBpZiAoIXRhYmxlKSByZXR1cm47XHJcblxyXG4gICAgY29uc3QgaGVhZGVyUm93ID0gdGFibGUucXVlcnlTZWxlY3RvcigndGhlYWQgdHInKTtcclxuICAgIGlmICghaGVhZGVyUm93KSByZXR1cm47XHJcblxyXG4gICAgY29uc3QgaGVhZGVycyA9IGhlYWRlclJvdy5xdWVyeVNlbGVjdG9yQWxsKCd0ZDpub3QoLmNoZWNrLWNlbGwtYXBwKScpO1xyXG5cclxuICAgIGhlYWRlcnMuZm9yRWFjaCgoaGVhZGVyLCBpbmRleCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHRoID0gaGVhZGVyIGFzIEhUTUxFbGVtZW50O1xyXG5cclxuICAgICAgICAvLyBBZ3JlZ2FyIGVzdGlsb3MgZGUgY3Vyc29yIHkgaWNvbm9cclxuICAgICAgICB0aC5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7XHJcbiAgICAgICAgdGguc3R5bGUudXNlclNlbGVjdCA9ICdub25lJztcclxuICAgICAgICB0aC5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XHJcblxyXG4gICAgICAgIC8vIEFncmVnYXIgaWNvbm8gZGUgb3JkZW5hbWllbnRvXHJcbiAgICAgICAgaWYgKCF0aC5xdWVyeVNlbGVjdG9yKCcuc29ydC1pY29uJykpIHtcclxuICAgICAgICAgICAgY29uc3QgaWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcclxuICAgICAgICAgICAgaWNvbi5jbGFzc05hbWUgPSAnZmEgZmEtc29ydCBzb3J0LWljb24nO1xyXG4gICAgICAgICAgICBpY29uLnN0eWxlLm1hcmdpbkxlZnQgPSAnNXB4JztcclxuICAgICAgICAgICAgaWNvbi5zdHlsZS5vcGFjaXR5ID0gJzAuNSc7XHJcbiAgICAgICAgICAgIGljb24uc3R5bGUuZm9udFNpemUgPSAnMTJweCc7XHJcbiAgICAgICAgICAgIHRoLmFwcGVuZENoaWxkKGljb24pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGguYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHNvcnRUYWJsZSh0YWJsZVNlbGVjdG9yLCBpbmRleCwgdGgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPcmRlbmEgbGEgdGFibGEgcG9yIGxhIGNvbHVtbmEgZXNwZWNpZmljYWRhLlxyXG4gKi9cclxuZnVuY3Rpb24gc29ydFRhYmxlKHRhYmxlU2VsZWN0b3I6IHN0cmluZywgY29sdW1uSW5kZXg6IG51bWJlciwgaGVhZGVyQ2VsbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0YWJsZVNlbGVjdG9yKSBhcyBIVE1MVGFibGVFbGVtZW50O1xyXG4gICAgaWYgKCF0YWJsZSkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IHRib2R5ID0gdGFibGUucXVlcnlTZWxlY3RvcigndGJvZHknKTtcclxuICAgIGlmICghdGJvZHkpIHJldHVybjtcclxuXHJcbiAgICAvLyBPYnRlbmVyIGVzdGFkbyBhY3R1YWxcclxuICAgIGNvbnN0IGN1cnJlbnRTdGF0ZSA9IHNvcnRTdGF0ZS5nZXQodGFibGVTZWxlY3Rvcik7XHJcbiAgICBsZXQgZGlyZWN0aW9uOiAnYXNjJyB8ICdkZXNjJyA9ICdhc2MnO1xyXG5cclxuICAgIGlmIChjdXJyZW50U3RhdGUgJiYgY3VycmVudFN0YXRlLmNvbHVtbiA9PT0gY29sdW1uSW5kZXgpIHtcclxuICAgICAgICBkaXJlY3Rpb24gPSBjdXJyZW50U3RhdGUuZGlyZWN0aW9uID09PSAnYXNjJyA/ICdkZXNjJyA6ICdhc2MnO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEd1YXJkYXIgbnVldm8gZXN0YWRvXHJcbiAgICBzb3J0U3RhdGUuc2V0KHRhYmxlU2VsZWN0b3IsIHsgY29sdW1uOiBjb2x1bW5JbmRleCwgZGlyZWN0aW9uIH0pO1xyXG5cclxuICAgIC8vIEFjdHVhbGl6YXIgaWNvbm9zIGRlIHRvZG9zIGxvcyBoZWFkZXJzXHJcbiAgICBjb25zdCBhbGxIZWFkZXJzID0gdGFibGUucXVlcnlTZWxlY3RvckFsbCgndGhlYWQgdGQ6bm90KC5jaGVjay1jZWxsLWFwcCknKTtcclxuICAgIGFsbEhlYWRlcnMuZm9yRWFjaCgoaCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGljb24gPSBoLnF1ZXJ5U2VsZWN0b3IoJy5zb3J0LWljb24nKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICBpZiAoaWNvbikge1xyXG4gICAgICAgICAgICBpY29uLmNsYXNzTmFtZSA9ICdmYSBmYS1zb3J0IHNvcnQtaWNvbic7XHJcbiAgICAgICAgICAgIGljb24uc3R5bGUub3BhY2l0eSA9ICcwLjUnO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEFjdHVhbGl6YXIgaWNvbm8gZGVsIGhlYWRlciBhY3R1YWxcclxuICAgIGNvbnN0IGN1cnJlbnRJY29uID0gaGVhZGVyQ2VsbC5xdWVyeVNlbGVjdG9yKCcuc29ydC1pY29uJykgYXMgSFRNTEVsZW1lbnQ7XHJcbiAgICBpZiAoY3VycmVudEljb24pIHtcclxuICAgICAgICBjdXJyZW50SWNvbi5jbGFzc05hbWUgPSBkaXJlY3Rpb24gPT09ICdhc2MnID8gJ2ZhIGZhLXNvcnQtYXNjIHNvcnQtaWNvbicgOiAnZmEgZmEtc29ydC1kZXNjIHNvcnQtaWNvbic7XHJcbiAgICAgICAgY3VycmVudEljb24uc3R5bGUub3BhY2l0eSA9ICcxJztcclxuICAgIH1cclxuXHJcbiAgICAvLyBPYnRlbmVyIGZpbGFzIHkgb3JkZW5hclxyXG4gICAgY29uc3Qgcm93cyA9IEFycmF5LmZyb20odGJvZHkucXVlcnlTZWxlY3RvckFsbCgndHIucm93LWFwcCcpKTtcclxuXHJcbiAgICByb3dzLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgICAvLyArMSBwb3JxdWUgbGEgcHJpbWVyYSBjZWxkYSBlcyBlbCBjaGVja2JveFxyXG4gICAgICAgIGNvbnN0IGNlbGxBID0gYS5xdWVyeVNlbGVjdG9yQWxsKCd0ZCcpW2NvbHVtbkluZGV4ICsgMV07XHJcbiAgICAgICAgY29uc3QgY2VsbEIgPSBiLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RkJylbY29sdW1uSW5kZXggKyAxXTtcclxuXHJcbiAgICAgICAgaWYgKCFjZWxsQSB8fCAhY2VsbEIpIHJldHVybiAwO1xyXG5cclxuICAgICAgICBsZXQgdmFsdWVBID0gKGNlbGxBLnRleHRDb250ZW50IHx8ICcnKS50cmltKCk7XHJcbiAgICAgICAgbGV0IHZhbHVlQiA9IChjZWxsQi50ZXh0Q29udGVudCB8fCAnJykudHJpbSgpO1xyXG5cclxuICAgICAgICAvLyBJbnRlbnRhciBjb21wYXJhciBjb21vIG7Dum1lcm9zXHJcbiAgICAgICAgY29uc3QgbnVtQSA9IHBhcnNlRmxvYXQodmFsdWVBLnJlcGxhY2UoL1teMC05Li1dL2csICcnKSk7XHJcbiAgICAgICAgY29uc3QgbnVtQiA9IHBhcnNlRmxvYXQodmFsdWVCLnJlcGxhY2UoL1teMC05Li1dL2csICcnKSk7XHJcblxyXG4gICAgICAgIGlmICghaXNOYU4obnVtQSkgJiYgIWlzTmFOKG51bUIpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkaXJlY3Rpb24gPT09ICdhc2MnID8gbnVtQSAtIG51bUIgOiBudW1CIC0gbnVtQTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEludGVudGFyIGNvbXBhcmFyIGNvbW8gZmVjaGFzIChmb3JtYXRvIGRkL21tL3l5eXkgbyBzaW1pbGFyKVxyXG4gICAgICAgIGNvbnN0IGRhdGVBID0gcGFyc2VEYXRlKHZhbHVlQSk7XHJcbiAgICAgICAgY29uc3QgZGF0ZUIgPSBwYXJzZURhdGUodmFsdWVCKTtcclxuXHJcbiAgICAgICAgaWYgKGRhdGVBICYmIGRhdGVCKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBkaXJlY3Rpb24gPT09ICdhc2MnXHJcbiAgICAgICAgICAgICAgICA/IGRhdGVBLmdldFRpbWUoKSAtIGRhdGVCLmdldFRpbWUoKVxyXG4gICAgICAgICAgICAgICAgOiBkYXRlQi5nZXRUaW1lKCkgLSBkYXRlQS5nZXRUaW1lKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDb21wYXJhciBjb21vIHRleHRvXHJcbiAgICAgICAgdmFsdWVBID0gdmFsdWVBLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgdmFsdWVCID0gdmFsdWVCLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICdhc2MnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZUEubG9jYWxlQ29tcGFyZSh2YWx1ZUIsICdlcycpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZUIubG9jYWxlQ29tcGFyZSh2YWx1ZUEsICdlcycpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFJlaW5zZXJ0YXIgZmlsYXMgb3JkZW5hZGFzXHJcbiAgICByb3dzLmZvckVhY2goKHJvdykgPT4gdGJvZHkuYXBwZW5kQ2hpbGQocm93KSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbnRlbnRhIHBhcnNlYXIgdW5hIGZlY2hhIGVuIHZhcmlvcyBmb3JtYXRvcyBjb211bmVzLlxyXG4gKi9cclxuZnVuY3Rpb24gcGFyc2VEYXRlKGRhdGVTdHI6IHN0cmluZyk6IERhdGUgfCBudWxsIHtcclxuICAgIGlmICghZGF0ZVN0cikgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgLy8gRm9ybWF0byBkZC9tbS95eXl5XHJcbiAgICBjb25zdCBwYXJ0czEgPSBkYXRlU3RyLm1hdGNoKC9eKFxcZHsxLDJ9KVxcLyhcXGR7MSwyfSlcXC8oXFxkezR9KSQvKTtcclxuICAgIGlmIChwYXJ0czEpIHtcclxuICAgICAgICByZXR1cm4gbmV3IERhdGUocGFyc2VJbnQocGFydHMxWzNdKSwgcGFyc2VJbnQocGFydHMxWzJdKSAtIDEsIHBhcnNlSW50KHBhcnRzMVsxXSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEZvcm1hdG8gbW0vZGQveXl5eVxyXG4gICAgY29uc3QgcGFydHMyID0gZGF0ZVN0ci5tYXRjaCgvXihcXGR7MSwyfSlcXC8oXFxkezEsMn0pXFwvKFxcZHs0fSkkLyk7XHJcbiAgICBpZiAocGFydHMyKSB7XHJcbiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHBhcnNlSW50KHBhcnRzMlszXSksIHBhcnNlSW50KHBhcnRzMlsxXSkgLSAxLCBwYXJzZUludChwYXJ0czJbMl0pKTtcclxuICAgICAgICBpZiAoIWlzTmFOKGRhdGUuZ2V0VGltZSgpKSkgcmV0dXJuIGRhdGU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRm9ybWF0byB5eXl5LW1tLWRkXHJcbiAgICBjb25zdCBwYXJ0czMgPSBkYXRlU3RyLm1hdGNoKC9eKFxcZHs0fSktKFxcZHsyfSktKFxcZHsyfSkkLyk7XHJcbiAgICBpZiAocGFydHMzKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHBhcnNlSW50KHBhcnRzM1sxXSksIHBhcnNlSW50KHBhcnRzM1syXSkgLSAxLCBwYXJzZUludChwYXJ0czNbM10pKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaWNpYWxpemEgdG9kYXMgbGFzIGZ1bmNpb25hbGlkYWRlcyBkZSB0YWJsYS5cclxuICogQHBhcmFtIGNvbmZpZyBDb25maWd1cmFjacOzbiBkZSBsYSB0YWJsYVxyXG4gKi9cclxuZnVuY3Rpb24gaW5pdFRhYmxlRmVhdHVyZXMoY29uZmlnOiB7XHJcbiAgICBmaWx0ZXJJbnB1dDogc3RyaW5nO1xyXG4gICAgdGFibGU6IHN0cmluZztcclxuICAgIHRib2R5OiBzdHJpbmc7XHJcbn0pOiB2b2lkIHtcclxuICAgIC8vIEVzcGVyYXIgYSBxdWUgZWwgRE9NIGVzdMOpIGxpc3RvXHJcbiAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcclxuICAgICAgICAgICAgaW5pdFRhYmxlRmlsdGVyKGNvbmZpZy5maWx0ZXJJbnB1dCwgY29uZmlnLnRhYmxlLCBjb25maWcudGJvZHkpO1xyXG4gICAgICAgICAgICBpbml0VGFibGVTb3J0KGNvbmZpZy50YWJsZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGluaXRUYWJsZUZpbHRlcihjb25maWcuZmlsdGVySW5wdXQsIGNvbmZpZy50YWJsZSwgY29uZmlnLnRib2R5KTtcclxuICAgICAgICBpbml0VGFibGVTb3J0KGNvbmZpZy50YWJsZSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIEV4cG9ydGFyIGFsIMOhbWJpdG8gZ2xvYmFsXHJcbih3aW5kb3cgYXMgYW55KS5pbml0VGFibGVGZWF0dXJlcyA9IGluaXRUYWJsZUZlYXR1cmVzO1xyXG4od2luZG93IGFzIGFueSkuaW5pdFRhYmxlRmlsdGVyID0gaW5pdFRhYmxlRmlsdGVyO1xyXG4od2luZG93IGFzIGFueSkuaW5pdFRhYmxlU29ydCA9IGluaXRUYWJsZVNvcnQ7XHJcbiJdfQ==